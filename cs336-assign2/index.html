<!doctype html><html lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>[斯坦福CS336]作业二：系统与并行计算 - LoveIt</title><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel=stylesheet><meta name=Description content="Hugo theme - LoveIt"><meta property="og:url" content="https://koschei.top/cs336-assign2/"><meta property="og:site_name" content="LoveIt"><meta property="og:title" content="[斯坦福CS336]作业二：系统与并行计算"><meta property="og:description" content="1 作业概述 本次作业中，你将亲自动手实践提升单 GPU 训练速度和将训练扩展到多 GPU 的方法。
需实现的内容 基准测试与性能分析工具 FlashAttention-2 的 Triton 内核 分布式数据并行训练 优化器状态分片 作业地址： Assignment2-systems GitHub仓库"><meta property="og:locale" content="zh_CN"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2026-01-31T00:49:00+08:00"><meta property="article:modified_time" content="2026-01-31T01:43:03+08:00"><meta property="article:tag" content="CS336"><meta property="article:tag" content="LLM"><meta property="og:image" content="https://koschei.top/logo.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://koschei.top/logo.png"><meta name=twitter:title content="[斯坦福CS336]作业二：系统与并行计算"><meta name=twitter:description content="1 作业概述 本次作业中，你将亲自动手实践提升单 GPU 训练速度和将训练扩展到多 GPU 的方法。
需实现的内容 基准测试与性能分析工具 FlashAttention-2 的 Triton 内核 分布式数据并行训练 优化器状态分片 作业地址： Assignment2-systems GitHub仓库"><meta name=application-name content="LoveIt"><meta name=apple-mobile-web-app-title content="LoveIt"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://koschei.top/cs336-assign2/><link rel=prev href=https://koschei.top/cs336-assign5/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.2/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.2/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"[斯坦福CS336]作业二：系统与并行计算","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/koschei.top\/cs336-assign2\/"},"image":[{"@type":"ImageObject","url":"https:\/\/koschei.top\/images\/Apple-Devices-Preview.png","width":3200,"height":2048}],"genre":"posts","keywords":"CS336, LLM","wordcount":1631,"url":"https:\/\/koschei.top\/cs336-assign2\/","datePublished":"2026-01-31T00:49:00+08:00","dateModified":"2026-01-31T01:43:03+08:00","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":"xxxx","logo":{"@type":"ImageObject","url":"https:\/\/koschei.top\/images\/avatar.png","width":960,"height":960}},"author":{"@type":"Person","name":"Koschei"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><canvas id=particles-canvas></canvas><div id=reading-progress-bar></div><style>#particles-canvas{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:-1;opacity:.6}[theme=dark] #particles-canvas{opacity:.4}#reading-progress-bar{position:fixed;top:0;left:0;width:0%;height:3px;background:linear-gradient(90deg,#6366f1,#8b5cf6,#a855f7,#ec4899);z-index:9999;transition:width 50ms ease-out;box-shadow:0 0 10px rgba(139,92,246,.5)}</style><script>(function(){const e=document.getElementById("particles-canvas"),t=e.getContext("2d");let n=[],i;const l=80,a=["#6366f1","#8b5cf6","#a855f7","#ec4899","#3b82f6","#14b8a6"];function r(){e.width=window.innerWidth,e.height=window.innerHeight}class d{constructor(){this.reset()}reset(){const n=e.width/2,s=e.height/2;this.angle=Math.random()*Math.PI*2;const t=Math.random()*100;this.x=n+Math.cos(this.angle)*t,this.y=s+Math.sin(this.angle)*t,this.speed=.2+Math.random()*.5,this.vx=Math.cos(this.angle)*this.speed,this.vy=Math.sin(this.angle)*this.speed,this.length=8+Math.random()*15,this.width=2+Math.random()*2,this.color=a[Math.floor(Math.random()*a.length)],this.opacity=.3+Math.random()*.5,this.rotation=this.angle,this.pulseSpeed=.01+Math.random()*.02,this.pulseOffset=Math.random()*Math.PI*2}update(){this.x+=this.vx,this.y+=this.vy,this.opacity=.3+Math.sin(Date.now()*this.pulseSpeed+this.pulseOffset)*.2;const t=100;(this.x<-t||this.x>e.width+t||this.y<-t||this.y>e.height+t)&&this.reset()}draw(){t.save(),t.translate(this.x,this.y),t.rotate(this.rotation),t.globalAlpha=this.opacity,t.beginPath(),t.roundRect(-this.length/2,-this.width/2,this.length,this.width,this.width/2),t.fillStyle=this.color,t.fill(),t.restore()}}function c(){n=[];for(let s=0;s<l;s++){const t=new d,o=Math.random()*Math.max(e.width,e.height)/2;t.x=e.width/2+Math.cos(t.angle)*o,t.y=e.height/2+Math.sin(t.angle)*o,n.push(t)}}function s(){t.clearRect(0,0,e.width,e.height);const o=t.createRadialGradient(e.width/2,e.height/2,0,e.width/2,e.height/2,Math.max(e.width,e.height)/2);o.addColorStop(0,"rgba(139, 92, 246, 0.03)"),o.addColorStop(.5,"rgba(99, 102, 241, 0.01)"),o.addColorStop(1,"transparent"),t.fillStyle=o,t.fillRect(0,0,e.width,e.height),n.forEach(e=>{e.update(),e.draw()}),i=requestAnimationFrame(s)}r(),c(),s(),window.addEventListener("resize",()=>{r(),c()}),document.addEventListener("visibilitychange",()=>{document.hidden?cancelAnimationFrame(i):s()});const u=document.getElementById("reading-progress-bar");function o(){const t=window.scrollY,e=document.documentElement.scrollHeight-window.innerHeight,n=e>0?t/e*100:0;u.style.width=n+"%"}window.addEventListener("scroll",o,{passive:!0}),window.addEventListener("resize",o,{passive:!0}),o()})()</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title=LoveIt><span class=header-title-pre><i class='far fa-kiss-wink-heart fa-fw' aria-hidden=true></i></span>LoveIt</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>所有文章 </a><a class=menu-item href=/tags/>标签 </a><a class=menu-item href=/categories/>分类 </a><a class=menu-item href=/categories/documentation/>文档 </a><a class=menu-item href=/about/>关于 </a><a class=menu-item href=https://github.com/dillonzq/LoveIt title=GitHub rel="noopener noreffer" target=_blank><i class='fab fa-github fa-fw' aria-hidden=true></i> </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder=搜索文章标题或内容... id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i>
</span></span><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题><i class="fas fa-adjust fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="menu-item language" title=选择语言><i class="fa fa-globe fa-fw" aria-hidden=true></i>
<select class=language-select id=language-select-desktop onchange="location=this.value"><option value=/cs336-assign2/ selected>简体中文</option></select></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=LoveIt><span class=header-title-pre><i class='far fa-kiss-wink-heart fa-fw' aria-hidden=true></i></span>LoveIt</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容... id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></div><a class=menu-item href=/posts/ title>所有文章</a><a class=menu-item href=/tags/ title>标签</a><a class=menu-item href=/categories/ title>分类</a><a class=menu-item href=/categories/documentation/ title>文档</a><a class=menu-item href=/about/ title>关于</a><a class=menu-item href=https://github.com/dillonzq/LoveIt title=GitHub rel="noopener noreffer" target=_blank><i class='fab fa-github fa-fw' aria-hidden=true></i></a><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class=menu-item title=选择语言><i class="fa fa-globe fa-fw" aria-hidden=true></i>
<select class=language-select onchange="location=this.value"><option value=/cs336-assign2/ selected>简体中文</option></select></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><meta name=referrer content="no-referrer-when-downgrade"><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>目录</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">[斯坦福CS336]作业二：系统与并行计算</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://github.com/kosthi title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Koschei</a></span>&nbsp;<span class=post-category>收录于 <a href=/categories/llm/><i class="far fa-folder fa-fw" aria-hidden=true></i>LLM</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2026-01-31>2026-01-31</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;约 1631 字&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;预计阅读 4 分钟&nbsp;<span id=busuanzi_container_page_pv>
<i class="far fa-eye fa-fw" aria-hidden=true></i>&nbsp;<span id=busuanzi_value_page_pv></span>&nbsp;次阅读
</span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#1-作业概述>1 作业概述</a><ul><li><a href=#需实现的内容>需实现的内容</a></li></ul></li><li><a href=#2-性能分析与基准测试>2 性能分析与基准测试</a><ul><li><a href=#21-动机>2.1 动机</a></li><li><a href=#22-模型规格>2.2 模型规格</a></li><li><a href=#23-端到端基准测试>2.3 端到端基准测试</a></li><li><a href=#作业题benchmarking_script4-分>作业题（benchmarking_script）：4 分</a></li><li><a href=#24-nsight-systems-性能分析工具>2.4 Nsight Systems 性能分析工具</a></li></ul></li></ul></nav></div></div><div class=content id=content><h2 id=1-作业概述>1 作业概述</h2><p>本次作业中，你将亲自动手实践提升单 GPU 训练速度和将训练扩展到多 GPU 的方法。</p><h3 id=需实现的内容>需实现的内容</h3><ol><li>基准测试与性能分析工具</li><li>FlashAttention-2 的 Triton 内核</li><li>分布式数据并行训练</li><li>优化器状态分片</li></ol><p>作业地址：
<a href=https://github.com/Kosthi/assignment2-systems target=_blank rel="noopener noreffer">Assignment2-systems GitHub仓库</a></p><p>接下来我将分享完成作业的一部分细节和心得。</p><h2 id=2-性能分析与基准测试>2 性能分析与基准测试</h2><h3 id=21-动机>2.1 动机</h3><p>在进行任何优化之前，先对程序进行性能分析是很有必要的，这能帮我们明确资源（如时间和内存）的消耗重点。否则，我们可能会在对整体性能影响不大的模块上浪费精力，无法带来显著的端到端性能提升。</p><p>我们将实现三种性能评估方案：</p><p>(a) 基于 Python 标准库的简单端到端基准测试，用于统计前向和反向传播耗时；</p><p>(b) 使用 NVIDIA Nsight Systems 工具分析计算过程，明确 CPU 和 GPU 上各操作的耗时分布；</p><p>(c) 内存使用情况分析。</p><h3 id=22-模型规格>2.2 模型规格</h3><p>在本次作业中，我们将对不同规格的模型进行基准测试和性能分析，以观察模型规模对性能的影响。所有模型的词汇量均设为 10000，批次大小设为 4，仅调整上下文长度。</p><p>不同模型规格参数如下：</p><table><thead><tr><th>模型规模</th><th>模型维度 $d_{model}$</th><th>前馈网络维度 $d_{ff}$</th><th>层数 $num_layers$</th><th>注意力头数 $num_heads$</th></tr></thead><tbody><tr><td>small</td><td>768</td><td>3072</td><td>12</td><td>12</td></tr><tr><td>medium</td><td>1024</td><td>4096</td><td>24</td><td>16</td></tr><tr><td>large</td><td>1280</td><td>5120</td><td>36</td><td>20</td></tr><tr><td>xl</td><td>1600</td><td>6400</td><td>48</td><td>25</td></tr><tr><td>2.7B</td><td>2560</td><td>10240</td><td>32</td><td>32</td></tr></tbody></table><h3 id=23-端到端基准测试>2.3 端到端基准测试</h3><p>首先，我们对模型进行最基础的性能分析 —— 统计前向和反向传播的耗时。由于我们只关注速度和内存，实验中可以使用随机初始化的权重和数据。</p><p>对于 GPU 代码进行基准测试时，需注意 CUDA 调用是异步的：调用内核后 CPU 会立即继续执行，因此直接测量函数返回时间无法反映 GPU 实际计算耗时。为了准确测量内核运行时间，应在测试前后调用 <code>torch.cuda.synchronize()</code> 以确保 GPU 操作完成。这是构建可靠性能分析工具的基础。</p><h3 id=作业题benchmarking_script4-分>作业题（benchmarking_script）：4 分</h3><p>(a) 编写一个脚本，对模型的前向和反向传播进行基础的端到端基准测试。具体来说，你的脚本需要支持以下功能：</p><ul><li>根据给定的超参数（如层数）初始化模型；</li><li>生成随机批次的测试数据；</li><li>先执行 <code>w</code> 次预热步骤（不计入正式计时），然后统计 <code>n</code> 次迭代的耗时（可通过参数控制仅测试前向传播，或同时测试前向和反向传播）；</li><li>计时工具可使用 Python 的 <code>timeit</code> 模块（例如 <code>timeit</code> 函数，或 <code>timeit.default_timer()</code>——该函数调用系统最高精度的时钟，比 <code>time.time()</code> 更适合基准测试）；</li><li>每次迭代后调用 <code>torch.cuda.synchronize()</code>。</li></ul><p>提交要求：一个脚本，能够根据给定超参数初始化基础 Transformer 模型，生成随机批次数据，并统计前向和反向传播的耗时。</p><blockquote><p><strong>答案</strong>：<a href=https://github.com/Kosthi/assignment2-systems/blob/main/tools/benchmarking_script.py target=_blank rel="noopener noreffer">benchmarking_script.py</a></p></blockquote><p>(b) 针对 1.1.2 节中描述的所有模型规格，统计其前向和反向传播的耗时。预热步骤设为 5 次，正式测试迭代 10 次，计算耗时的平均值和标准差。前向传播耗时多少？反向传播呢？测试结果的波动性大吗？标准差是否较小？</p><p>提交要求：1-2 句话，简要说明你的测试结果。</p><blockquote><p><strong>答案</strong>：前向与反向传播耗时随模型规格增大而显著增加（反向耗时约为前向的 1.8 倍）。测试结果中，仅 large 模型在前向传播阶段表现出异常高的波动（标准差约 15.6ms），其余所有模型标准差均低于 1ms，整体稳定性极高。</p></blockquote><table><thead><tr><th style=text-align:left>Model</th><th style=text-align:right>Total Mean (ms)</th><th style=text-align:right>Total Std (ms)</th><th style=text-align:right>Forward Mean (ms)</th><th style=text-align:right>Forward Std (ms)</th><th style=text-align:right>Backward Mean (ms)</th><th style=text-align:right>Backward Std (ms)</th></tr></thead><tbody><tr><td style=text-align:left>small</td><td style=text-align:right>57.199</td><td style=text-align:right>0.36</td><td style=text-align:right>20.577</td><td style=text-align:right>0.114</td><td style=text-align:right>36.623</td><td style=text-align:right>0.296</td></tr><tr><td style=text-align:left>medium</td><td style=text-align:right>150.074</td><td style=text-align:right>0.305</td><td style=text-align:right>50.899</td><td style=text-align:right>0.191</td><td style=text-align:right>99.175</td><td style=text-align:right>0.24</td></tr><tr><td style=text-align:left><strong>large</strong></td><td style=text-align:right>343.988</td><td style=text-align:right><strong>15.576</strong></td><td style=text-align:right>121.522</td><td style=text-align:right><strong>15.565</strong></td><td style=text-align:right>222.466</td><td style=text-align:right>0.487</td></tr><tr><td style=text-align:left>xl</td><td style=text-align:right>647.669</td><td style=text-align:right>0.492</td><td style=text-align:right>226.776</td><td style=text-align:right>0.134</td><td style=text-align:right>420.893</td><td style=text-align:right>0.46</td></tr><tr><td style=text-align:left>2.7B</td><td style=text-align:right>931.531</td><td style=text-align:right>0.788</td><td style=text-align:right>334.754</td><td style=text-align:right>0.25</td><td style=text-align:right>596.778</td><td style=text-align:right>0.563</td></tr></tbody></table><p>(c) 基准测试的一个常见误区是<strong>不执行预热步骤</strong>。请重复上述实验，但不进行预热，观察这会对结果产生什么影响？你认为原因是什么？另外，尝试将预热步骤设为 1 或 2 次，结果为何仍然会有差异？</p><p>提交要求：2-3 句话，回答上述问题。</p><blockquote><p><strong>答案</strong>：不执行预热会导致平均耗时显著增加且方差极大，这是因为测试数据包含了 CUDA 上下文初始化、显存分配及内核编译 等高昂的一次性开销。仅进行 1-2 次预热结果仍有差异，是因为 GPU 往往需要更多迭代才能 将时钟频率提升至高性能状态（Clock Boost） 并使硬件调度达到稳态，短期预热不足以完全消除这种硬件延迟。</p></blockquote><p>未执行预热结果：</p><table><thead><tr><th style=text-align:left>Model</th><th style=text-align:right>Total Mean (ms)</th><th style=text-align:right>Total Std (ms)</th><th style=text-align:right>Forward Mean (ms)</th><th style=text-align:right>Forward Std (ms)</th><th style=text-align:right>Backward Mean (ms)</th><th style=text-align:right>Backward Std (ms)</th></tr></thead><tbody><tr><td style=text-align:left>small</td><td style=text-align:right>108.639</td><td style=text-align:right>162.533</td><td style=text-align:right>61.526</td><td style=text-align:right>129.748</td><td style=text-align:right>47.114</td><td style=text-align:right>32.788</td></tr><tr><td style=text-align:left>medium</td><td style=text-align:right>205.943</td><td style=text-align:right>168.338</td><td style=text-align:right>91.845</td><td style=text-align:right>126.576</td><td style=text-align:right>114.097</td><td style=text-align:right>41.762</td></tr><tr><td style=text-align:left>large</td><td style=text-align:right>403.33</td><td style=text-align:right>183.065</td><td style=text-align:right>164.772</td><td style=text-align:right>146.419</td><td style=text-align:right>238.558</td><td style=text-align:right>36.71</td></tr><tr><td style=text-align:left>xl</td><td style=text-align:right>717.864</td><td style=text-align:right>219.592</td><td style=text-align:right>282.802</td><td style=text-align:right>175.108</td><td style=text-align:right>435.062</td><td style=text-align:right>44.488</td></tr><tr><td style=text-align:left>2.7B</td><td style=text-align:right>984.532</td><td style=text-align:right>165.056</td><td style=text-align:right>377.542</td><td style=text-align:right>134.342</td><td style=text-align:right>606.99</td><td style=text-align:right>30.722</td></tr></tbody></table><p>预热 2 次后结果：</p><table><thead><tr><th style=text-align:left>Model</th><th style=text-align:right>Total Mean (ms)</th><th style=text-align:right>Total Std (ms)</th><th style=text-align:right>Forward Mean (ms)</th><th style=text-align:right>Forward Std (ms)</th><th style=text-align:right>Backward Mean (ms)</th><th style=text-align:right>Backward Std (ms)</th></tr></thead><tbody><tr><td style=text-align:left>small</td><td style=text-align:right>57.415</td><td style=text-align:right>0.589</td><td style=text-align:right>20.679</td><td style=text-align:right>0.514</td><td style=text-align:right>36.735</td><td style=text-align:right>0.354</td></tr><tr><td style=text-align:left>medium</td><td style=text-align:right>152.697</td><td style=text-align:right>0.249</td><td style=text-align:right>51.815</td><td style=text-align:right>0.108</td><td style=text-align:right>100.882</td><td style=text-align:right>0.222</td></tr><tr><td style=text-align:left><strong>large</strong></td><td style=text-align:right>346.826</td><td style=text-align:right><strong>16.261</strong></td><td style=text-align:right>122.62</td><td style=text-align:right><strong>16.389</strong></td><td style=text-align:right>224.206</td><td style=text-align:right><strong>1.992</strong></td></tr><tr><td style=text-align:left>xl</td><td style=text-align:right>647.414</td><td style=text-align:right>0.774</td><td style=text-align:right>226.728</td><td style=text-align:right>0.106</td><td style=text-align:right>420.685</td><td style=text-align:right>0.695</td></tr><tr><td style=text-align:left>2.7B</td><td style=text-align:right>932.151</td><td style=text-align:right>0.744</td><td style=text-align:right>334.898</td><td style=text-align:right>0.105</td><td style=text-align:right>597.253</td><td style=text-align:right>0.738</td></tr></tbody></table><h3 id=24-nsight-systems-性能分析工具>2.4 Nsight Systems 性能分析工具</h3></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>更新于 2026-01-31&nbsp;<a class=git-hash href=https://github.com/dillonzq/LoveIt/commit/d75bc3722331736783fbd758dc16dbdfce761082 target=_blank title="commit by Koschei(nitianzero@gmail.com) d75bc3722331736783fbd758dc16dbdfce761082: feat: update cs336-assign2">
<i class="fas fa-hashtag fa-fw" aria-hidden=true></i>d75bc37</a></span></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/cs336-assign2/index.md target=_blank>阅读原始文档</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 X" data-sharer=x data-url=https://koschei.top/cs336-assign2/ data-title=[斯坦福CS336]作业二：系统与并行计算 data-hashtags=CS336,LLM><i class="fab fa-x-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=https://koschei.top/cs336-assign2/ data-hashtag=CS336><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 Hacker News" data-sharer=hackernews data-url=https://koschei.top/cs336-assign2/ data-title=[斯坦福CS336]作业二：系统与并行计算><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 Line" data-sharer=line data-url=https://koschei.top/cs336-assign2/ data-title=[斯坦福CS336]作业二：系统与并行计算><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@14.9.0/icons/line.svg aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://koschei.top/cs336-assign2/ data-title=[斯坦福CS336]作业二：系统与并行计算 data-ralateuid=xxxx><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/cs336/>CS336</a>,&nbsp;<a href=/tags/llm/>LLM</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/cs336-assign5/ class=prev rel=prev title=[斯坦福CS336]作业五：对齐与推理强化学习><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>[斯坦福CS336]作业五：对齐与推理强化学习</a></div></div><div id=comments><div id=twikoo class=comment></div><script src=https://cdn.jsdelivr.net/npm/twikoo@1.6.44/dist/twikoo.all.min.js></script><script>twikoo.init({envId:"https://koschei.netlify.app/.netlify/functions/twikoo",el:"#twikoo",path:location.pathname,lang:"zh-CN"});const updateTwikooTheme=()=>{const e=document.body.getAttribute("theme")==="dark";document.documentElement.setAttribute("data-theme",e?"dark":"light")};updateTwikooTheme();const observer=new MutationObserver(e=>{e.forEach(e=>{e.attributeName==="theme"&&updateTwikooTheme()})});observer.observe(document.body,{attributes:!0})</script><noscript>请启用 JavaScript 以查看由 <a href=https://twikoo.js.org/ rel="nofollow noopener noreferrer" target=_blank>Twikoo</a> 提供的评论。</noscript></div></article></div></main><footer class=footer><div class=footer-container><div id=run-time data-start-time=2025-03-04T20:39:00+08:00 data-i18n-runtime="本站已运行 <i class='far fa-clock fa-fw'></i> %%DAYS%% 天 %%HOURS%% 小时 %%MINUTES%% 分钟 %%SECONDS%% 秒"></div><div class=footer-line>由 <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.155.1">Hugo</a> 强力驱动 | 主题 - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.3.0"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2025 - 2026</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://github.com/kosthi target=_blank>Koschei</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span><span class=icp-splitter>&nbsp;|&nbsp;</span><br class=icp-br><span class=icp><a href="https://beian.mps.gov.cn/#/query/webSearch?code=33032602100584" rel=noreferrer target=_blank><img src=/备案图标.png alt=备案图标 style=vertical-align:middle;width:16px>浙公网安备33032602100584号</a></span><span class=icp-splitter>&nbsp;|&nbsp;</span><br class=icp-br><span class=icp><a href=https://beian.miit.gov.cn/ rel=noreferrer target=_blank>浙ICP备2024075396号-2</a></span></div><div class=busuanzi-footer><span id=busuanzi_container_site_pv><i class="fa fa-eye"></i> <span id=busuanzi_value_site_pv></span>
</span>&nbsp;|&nbsp;
<span id=busuanzi_container_site_uv><i class="fa fa-user"></i> <span id=busuanzi_value_site_uv></span></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title=回到顶部><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i></a></div><div id=fixed-buttons-hidden><a href=# id=view-comments class=fixed-button title=查看评论><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/css/lightgallery-bundle.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.css><script src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script src=https://cdn.jsdelivr.net/npm/algoliasearch@5.20.2/dist/lite/builds/browser.umd.min.js></script><script src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/lightgallery.min.js></script><script src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/thumbnail/lg-thumbnail.min.js></script><script src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/zoom/lg-zoom.min.js></script><script src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.2/sharer.min.js></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.js></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/contrib/auto-render.min.js></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/contrib/copy-tex.min.js></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/contrib/mhchem.min.js></script><script>window.config={lightgallery:!0,math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{algoliaAppID:"GZT24PWKNT",algoliaIndex:"index",algoliaSearchKey:"634ab679e825b815de2663de38908f9d",highlightTag:"em",maxResultLength:10,noResultsFound:"没有找到结果",snippetLength:50,type:"algolia"}}</script><script src=/js/theme.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/jquery@2.1.3/dist/jquery.min.js></script><script type=text/javascript src=/js/custom.js></script></body></html>